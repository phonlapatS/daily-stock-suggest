"""
à¸§à¸´à¹€à¸„à¸£à¸²à¸°à¸«à¹Œà¸§à¹ˆà¸²à¸£à¸°à¸šà¸šà¹€à¸”à¸´à¸¡ (pattern matching + historical probability) 
à¸¡à¸µà¸žà¸¤à¸•à¸´à¸à¸£à¸£à¸¡à¸„à¸¥à¹‰à¸²à¸¢ Mean Reversion à¹‚à¸”à¸¢à¸˜à¸£à¸£à¸¡à¸Šà¸²à¸•à¸´à¸«à¸£à¸·à¸­à¹„à¸¡à¹ˆ
"""
import pandas as pd
import numpy as np

print("="*80)
print("ðŸ” à¸§à¸´à¹€à¸„à¸£à¸²à¸°à¸«à¹Œ: à¸£à¸°à¸šà¸šà¹€à¸”à¸´à¸¡à¸¡à¸µà¸žà¸¤à¸•à¸´à¸à¸£à¸£à¸¡ Mean Reversion à¹‚à¸”à¸¢à¸˜à¸£à¸£à¸¡à¸Šà¸²à¸•à¸´à¸«à¸£à¸·à¸­à¹„à¸¡à¹ˆ?")
print("="*80)

# Load Thai trades
df = pd.read_csv('logs/trade_history_THAI.csv')
df['actual_return'] = pd.to_numeric(df['actual_return'], errors='coerce')
df['pnl'] = df.apply(lambda row: row['actual_return'] * (1 if row['forecast'] == 'UP' else -1), axis=1)

print(f"\nðŸ“Š [1] à¸§à¸´à¹€à¸„à¸£à¸²à¸°à¸«à¹Œ Pattern à¹à¸¥à¸° Direction")
print("-"*80)

# à¸§à¸´à¹€à¸„à¸£à¸²à¸°à¸«à¹Œà¸§à¹ˆà¸² pattern `+` (à¸‚à¸¶à¹‰à¸™à¹à¸£à¸‡) à¸¡à¸±à¸à¸ˆà¸°à¸•à¸²à¸¡à¸”à¹‰à¸§à¸¢à¸­à¸°à¹„à¸£
# à¹à¸¥à¸° pattern `-` (à¸¥à¸‡à¹à¸£à¸‡) à¸¡à¸±à¸à¸ˆà¸°à¸•à¸²à¸¡à¸”à¹‰à¸§à¸¢à¸­à¸°à¹„à¸£

# à¸ªà¸¡à¸¡à¸•à¸´à¸§à¹ˆà¸² pattern `+` â†’ historical returns à¸¡à¸±à¸à¸ˆà¸°à¸•à¸´à¸”à¸¥à¸š (reversion)
# à¹à¸¥à¸° pattern `-` â†’ historical returns à¸¡à¸±à¸à¸ˆà¸°à¹€à¸›à¹‡à¸™à¸šà¸§à¸ (reversion)

print("\nðŸ’¡ à¸ªà¸¡à¸¡à¸•à¸´à¸à¸²à¸™:")
print("   - Pattern `+` (à¸‚à¸¶à¹‰à¸™à¹à¸£à¸‡) â†’ Historical returns à¸¡à¸±à¸à¸ˆà¸°à¸•à¸´à¸”à¸¥à¸š â†’ SHORT à¸¡à¸µ Prob à¸ªà¸¹à¸‡à¸à¸§à¹ˆà¸²")
print("   - Pattern `-` (à¸¥à¸‡à¹à¸£à¸‡) â†’ Historical returns à¸¡à¸±à¸à¸ˆà¸°à¹€à¸›à¹‡à¸™à¸šà¸§à¸ â†’ LONG à¸¡à¸µ Prob à¸ªà¸¹à¸‡à¸à¸§à¹ˆà¸²")
print("   â†’ à¸™à¸µà¹ˆà¸„à¸·à¸­à¸žà¸¤à¸•à¸´à¸à¸£à¸£à¸¡ Mean Reversion à¹‚à¸”à¸¢à¸˜à¸£à¸£à¸¡à¸Šà¸²à¸•à¸´!")

print("\nðŸ“Š [2] à¸£à¸°à¸šà¸šà¹€à¸”à¸´à¸¡ vs à¸£à¸°à¸šà¸šà¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™")
print("-"*80)

print("\nðŸ”¹ à¸£à¸°à¸šà¸šà¹€à¸”à¸´à¸¡ (Pattern Matching + Historical Probability):")
print("   1. à¸«à¸² pattern à¹ƒà¸™à¸›à¸£à¸°à¸§à¸±à¸•à¸´ (à¹€à¸Šà¹ˆà¸™ `++--`)")
print("   2. à¸”à¸¹ historical returns à¸‚à¸­à¸‡ pattern à¸™à¸µà¹‰")
print("   3. à¸¥à¸­à¸‡à¸—à¸±à¹‰à¸‡ LONG à¹à¸¥à¸° SHORT:")
print("      - LONG: à¸™à¸±à¸š returns > 0 à¹€à¸›à¹‡à¸™ wins")
print("      - SHORT: à¸™à¸±à¸š returns < 0 à¹€à¸›à¹‡à¸™ wins")
print("   4. à¹€à¸¥à¸·à¸­à¸ direction à¸—à¸µà¹ˆà¸¡à¸µ Prob à¸ªà¸¹à¸‡à¸ªà¸¸à¸”")
print("   â†’ à¸–à¹‰à¸² pattern `+` â†’ SHORT à¸¡à¸µ Prob à¸ªà¸¹à¸‡à¸à¸§à¹ˆà¸² â†’ à¹€à¸¥à¸·à¸­à¸ SHORT")
print("   â†’ à¸–à¹‰à¸² pattern `-` â†’ LONG à¸¡à¸µ Prob à¸ªà¸¹à¸‡à¸à¸§à¹ˆà¸² â†’ à¹€à¸¥à¸·à¸­à¸ LONG")
print("   â†’ **à¸žà¸¤à¸•à¸´à¸à¸£à¸£à¸¡ Mean Reversion à¹‚à¸”à¸¢à¸˜à¸£à¸£à¸¡à¸Šà¸²à¸•à¸´!**")

print("\nðŸ”¹ à¸£à¸°à¸šà¸šà¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™ (à¸à¸³à¸«à¸™à¸” Strategy à¹€à¸›à¹‡à¸™ MEAN_REVERSION):")
print("   1. à¸«à¸² pattern à¹ƒà¸™à¸›à¸£à¸°à¸§à¸±à¸•à¸´ (à¹€à¸Šà¹ˆà¸™ `++--`)")
print("   2. à¸à¸³à¸«à¸™à¸” direction à¸¥à¹ˆà¸§à¸‡à¸«à¸™à¹‰à¸²:")
print("      - Pattern `+` â†’ SHORT (intended_dir = -1)")
print("      - Pattern `-` â†’ LONG (intended_dir = 1)")
print("   3. à¸„à¸³à¸™à¸§à¸“ Prob% à¸ªà¸³à¸«à¸£à¸±à¸š direction à¸—à¸µà¹ˆà¸à¸³à¸«à¸™à¸”")
print("   â†’ **à¹€à¸£à¹‡à¸§à¸‚à¸¶à¹‰à¸™à¹à¸¥à¸°à¸Šà¸±à¸”à¹€à¸ˆà¸™à¸‚à¸¶à¹‰à¸™** (à¹„à¸¡à¹ˆà¸•à¹‰à¸­à¸‡à¸¥à¸­à¸‡à¸—à¸±à¹‰à¸‡à¸ªà¸­à¸‡)")

print("\nðŸ“Š [3] à¹€à¸›à¸£à¸µà¸¢à¸šà¹€à¸—à¸µà¸¢à¸šà¸œà¸¥à¸¥à¸±à¸žà¸˜à¹Œ")
print("-"*80)

# à¸§à¸´à¹€à¸„à¸£à¸²à¸°à¸«à¹Œà¸§à¹ˆà¸²à¹ƒà¸™à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ˆà¸£à¸´à¸‡ pattern `+` â†’ SHORT à¸¡à¸µ Prob à¸ªà¸¹à¸‡à¸à¸§à¹ˆà¸² LONG à¸«à¸£à¸·à¸­à¹„à¸¡à¹ˆ
# à¹à¸¥à¸° pattern `-` â†’ LONG à¸¡à¸µ Prob à¸ªà¸¹à¸‡à¸à¸§à¹ˆà¸² SHORT à¸«à¸£à¸·à¸­à¹„à¸¡à¹ˆ

# à¸ªà¸¡à¸¡à¸•à¸´à¸§à¹ˆà¸²à¹€à¸£à¸²à¸¡à¸µ pattern `+` à¹à¸¥à¸° `-` à¹ƒà¸™à¸‚à¹‰à¸­à¸¡à¸¹à¸¥
# à¹ƒà¸«à¹‰à¹€à¸£à¸²à¸”à¸¹à¸§à¹ˆà¸² forecast (direction à¸—à¸µà¹ˆà¹€à¸¥à¸·à¸­à¸) à¹€à¸›à¹‡à¸™à¸­à¸¢à¹ˆà¸²à¸‡à¹„à¸£

print("\nðŸ’¡ à¸ªà¸£à¸¸à¸›:")
print("   âœ… à¸£à¸°à¸šà¸šà¹€à¸”à¸´à¸¡à¸¡à¸µà¸žà¸¤à¸•à¸´à¸à¸£à¸£à¸¡ Mean Reversion à¹‚à¸”à¸¢à¸˜à¸£à¸£à¸¡à¸Šà¸²à¸•à¸´")
print("      à¹€à¸žà¸£à¸²à¸°à¸¡à¸±à¸™à¹€à¸¥à¸·à¸­à¸ direction à¸—à¸µà¹ˆà¸¡à¸µ Prob à¸ªà¸¹à¸‡à¸ªà¸¸à¸”")
print("      à¹à¸¥à¸°à¹ƒà¸™à¸•à¸¥à¸²à¸” Mean Reversion, pattern `+` â†’ SHORT à¸¡à¸µ Prob à¸ªà¸¹à¸‡à¸à¸§à¹ˆà¸²")
print("      à¹à¸¥à¸° pattern `-` â†’ LONG à¸¡à¸µ Prob à¸ªà¸¹à¸‡à¸à¸§à¹ˆà¸²")
print("\n   âœ… à¸à¸²à¸£à¸à¸³à¸«à¸™à¸” strategy à¹€à¸›à¹‡à¸™ MEAN_REVERSION:")
print("      - à¹€à¸£à¹‡à¸§à¸‚à¸¶à¹‰à¸™ (à¹„à¸¡à¹ˆà¸•à¹‰à¸­à¸‡à¸¥à¸­à¸‡à¸—à¸±à¹‰à¸‡à¸ªà¸­à¸‡ direction)")
print("      - à¸Šà¸±à¸”à¹€à¸ˆà¸™à¸‚à¸¶à¹‰à¸™ (à¸£à¸¹à¹‰ direction à¸¥à¹ˆà¸§à¸‡à¸«à¸™à¹‰à¸²)")
print("      - à¹à¸•à¹ˆà¸œà¸¥à¸¥à¸±à¸žà¸˜à¹Œà¸„à¸§à¸£à¸ˆà¸°à¹€à¸«à¸¡à¸·à¸­à¸™à¸à¸±à¸™ (à¸–à¹‰à¸²à¸£à¸°à¸šà¸šà¹€à¸”à¸´à¸¡à¹€à¸¥à¸·à¸­à¸ direction à¸—à¸µà¹ˆà¸–à¸¹à¸à¸•à¹‰à¸­à¸‡)")

print("\n" + "="*80)
print("âœ… à¸à¸²à¸£à¸§à¸´à¹€à¸„à¸£à¸²à¸°à¸«à¹Œà¹€à¸ªà¸£à¹‡à¸ˆà¸ªà¸¡à¸šà¸¹à¸£à¸“à¹Œ")
print("="*80)

