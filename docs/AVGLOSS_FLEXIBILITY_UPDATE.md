# AvgLoss% Flexibility Update - ‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ AvgLoss% ‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô

**‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:** 2026-02-13  
**‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:** ‚úÖ ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå

---

## üìã ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö

AvgLoss% ‡∏î‡∏π lock ‡πÑ‡∏õ‡∏´‡∏ô‡πà‡∏≠‡∏¢ (‡∏Ñ‡πà‡∏≤‡∏Ñ‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≤‡∏á‡∏Ñ‡∏á‡∏ó‡∏µ‡πà):
- **Count >= 30**: AvgLoss% ‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà 1.11-1.86% (‡∏Ñ‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≤‡∏á‡∏Ñ‡∏á‡∏ó‡∏µ‡πà)
- **Count >= 15**: AvgLoss% ‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà 2.22-2.99% (‡∏Ñ‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≤‡∏á‡∏Ñ‡∏á‡∏ó‡∏µ‡πà)

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:**
1. **THAI market**: ‡πÉ‡∏ä‡πâ Fixed SL 1.5% ‚Üí ‡∏ó‡∏≥‡πÉ‡∏´‡πâ AvgLoss% lock ‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà ~1.5%
2. **ATR-based markets**: ‡∏°‡∏µ cap ‡∏ó‡∏µ‡πà 5% SL ‚Üí ‡πÑ‡∏°‡πà‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô‡∏û‡∏≠
3. **Fallback ATR**: = 2% ‚Üí ‡∏ó‡∏≥‡πÉ‡∏´‡πâ lock ‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà ~2%

---

## ‚úÖ ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç

### 1. ‡πÄ‡∏û‡∏¥‡πà‡∏° Cap ‡∏Ç‡∏≠‡∏á ATR-based SL/TP

**Before:**
```python
actual_sl_pct = min(actual_sl_pct, 5.0)   # Max 5% SL
actual_tp_pct = min(actual_tp_pct, 12.0)   # Max 12% TP
```

**After:**
```python
actual_sl_pct = min(actual_sl_pct, 7.0)   # Max 7% SL (‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å 5% ‚Üí 7% ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô)
actual_tp_pct = min(actual_tp_pct, 15.0)  # Max 15% TP (‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å 12% ‚Üí 15% ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô)
```

**‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö:**
- ‚úÖ ATR-based markets (US, CHINA/HK, TAIWAN) ‡∏à‡∏∞‡∏°‡∏µ AvgLoss% ‡∏ó‡∏µ‡πà‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô
- ‚úÖ ‡∏´‡∏∏‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ú‡∏±‡∏ô‡∏ú‡∏ß‡∏ô‡∏°‡∏≤‡∏Å‡∏à‡∏∞‡πÑ‡∏î‡πâ SL ‡∏ó‡∏µ‡πà‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô (‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 7%)
- ‚úÖ ‡∏´‡∏∏‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ú‡∏±‡∏ô‡∏ú‡∏ß‡∏ô‡∏ô‡πâ‡∏≠‡∏¢‡∏à‡∏∞‡πÑ‡∏î‡πâ SL ‡∏ó‡∏µ‡πà‡πÅ‡∏Ñ‡∏ö‡∏•‡∏á (‡∏ï‡∏≤‡∏° ATR ‡∏à‡∏£‡∏¥‡∏á)

---

### 2. ‡∏õ‡∏£‡∏±‡∏ö Fallback ATR ‡πÉ‡∏´‡πâ‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô

**Before:**
```python
if pd.isna(atr_val) or atr_val <= 0:
    atr_val = entry_price * 0.02  # Fallback 2%
```

**After:**
```python
if pd.isna(atr_val) or atr_val <= 0:
    # Fallback: ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤ ATR ‡∏ó‡∏µ‡πà‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å volatility ‡∏à‡∏£‡∏¥‡∏á (‡πÑ‡∏°‡πà lock ‡∏ó‡∏µ‡πà 2%)
    # ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å rolling std ‡∏Ç‡∏≠‡∏á price change (20 days)
    if entry_idx >= 20:
        price_changes = df['close'].pct_change().iloc[max(0, entry_idx-20):entry_idx+1]
        atr_val = entry_price * price_changes.std() * 1.5  # 1.5x std as ATR estimate
        if pd.isna(atr_val) or atr_val <= 0:
            atr_val = entry_price * 0.015  # Fallback 1.5% (‡∏•‡∏î‡∏à‡∏≤‡∏Å 2% ‚Üí 1.5%)
    else:
        atr_val = entry_price * 0.015  # Fallback 1.5% (‡∏•‡∏î‡∏à‡∏≤‡∏Å 2% ‚Üí 1.5%)
```

**‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö:**
- ‚úÖ Fallback ATR ‡∏à‡∏∞‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å volatility ‡∏à‡∏£‡∏¥‡∏á (rolling std 20 days)
- ‚úÖ ‡πÑ‡∏°‡πà lock ‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà 2% ‡πÅ‡∏ï‡πà‡∏à‡∏∞‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô‡∏ï‡∏≤‡∏° volatility ‡∏Ç‡∏≠‡∏á‡∏´‡∏∏‡πâ‡∏ô
- ‚úÖ ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠ ‡∏à‡∏∞‡πÉ‡∏ä‡πâ 1.5% (‡∏•‡∏î‡∏à‡∏≤‡∏Å 2% ‚Üí 1.5%)

---

## üìä ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á

### ATR-based Markets (US, CHINA/HK, TAIWAN):
- ‚úÖ AvgLoss% ‡∏à‡∏∞‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô (1.0% - 7.0% ‡∏ï‡∏≤‡∏° ATR ‡∏à‡∏£‡∏¥‡∏á)
- ‚úÖ ‡∏´‡∏∏‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ú‡∏±‡∏ô‡∏ú‡∏ß‡∏ô‡∏°‡∏≤‡∏Å ‚Üí AvgLoss% ‡∏™‡∏π‡∏á‡∏Ç‡∏∂‡πâ‡∏ô (‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 7%)
- ‚úÖ ‡∏´‡∏∏‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ú‡∏±‡∏ô‡∏ú‡∏ß‡∏ô‡∏ô‡πâ‡∏≠‡∏¢ ‚Üí AvgLoss% ‡∏ï‡πà‡∏≥‡∏•‡∏á (‡∏ï‡∏≤‡∏° ATR ‡∏à‡∏£‡∏¥‡∏á)
- ‚úÖ ‡πÑ‡∏°‡πà lock ‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏µ‡∏¢‡∏ß

### THAI Market:
- ‚ö†Ô∏è ‡∏¢‡∏±‡∏á‡πÉ‡∏ä‡πâ Fixed SL 1.5% ‡∏ï‡∏≤‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ (design choice)
- ‚ÑπÔ∏è ‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô ‡∏≠‡∏≤‡∏à‡∏ï‡πâ‡∏≠‡∏á‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô ATR-based

---

## üîç ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏

1. **THAI Market**: ‡∏¢‡∏±‡∏á‡πÉ‡∏ä‡πâ Fixed SL/TP ‡∏ï‡∏≤‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ `STRATEGY_TABLE_BY_COUNTRY.md`
   - ‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô ‡∏≠‡∏≤‡∏à‡∏ï‡πâ‡∏≠‡∏á‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô ATR-based
   - ‡πÅ‡∏ï‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏î‡πâ‡∏ß‡∏¢

2. **Cap 7% SL**: ‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡∏°‡∏µ cap ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô wild swings
   - ‡πÅ‡∏ï‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å 5% ‚Üí 7% ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô

3. **Fallback ATR**: ‡πÉ‡∏ä‡πâ rolling std ‡πÅ‡∏ó‡∏ô fixed value
   - ‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô‡∏ï‡∏≤‡∏° volatility ‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡∏´‡∏∏‡πâ‡∏ô
   - ‡πÑ‡∏°‡πà lock ‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏µ‡∏¢‡∏ß

---

## ‚úÖ ‡∏™‡∏£‡∏∏‡∏õ

**‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
- ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏° cap ‡∏Ç‡∏≠‡∏á ATR-based SL ‡∏à‡∏≤‡∏Å 5% ‚Üí 7%
- ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏° cap ‡∏Ç‡∏≠‡∏á ATR-based TP ‡∏à‡∏≤‡∏Å 12% ‚Üí 15%
- ‚úÖ ‡∏õ‡∏£‡∏±‡∏ö fallback ATR ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ rolling std ‡πÅ‡∏ó‡∏ô fixed value
- ‚úÖ ‡∏•‡∏î fallback ‡∏à‡∏≤‡∏Å 2% ‚Üí 1.5%

**‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå:**
- ‚úÖ AvgLoss% ‡∏à‡∏∞‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô (‡πÑ‡∏°‡πà lock ‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏µ‡∏¢‡∏ß)
- ‚úÖ ATR-based markets ‡∏à‡∏∞‡∏™‡∏∞‡∏ó‡πâ‡∏≠‡∏ô volatility ‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡∏´‡∏∏‡πâ‡∏ô
- ‚úÖ ‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡∏°‡∏µ cap ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô wild swings

---

**Status:** ‚úÖ Complete - AvgLoss% ‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡πÅ‡∏•‡πâ‡∏ß

