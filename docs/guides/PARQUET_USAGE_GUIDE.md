# ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Parquet Files

## üéØ Workflow: ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‚Üí ‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå

```
Step 1: ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡∏ó‡∏≥‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‡∏´‡∏£‡∏∑‡∏≠ daily update)
   python data_updater.py
   ‚Üì
   ‡∏™‡∏£‡πâ‡∏≤‡∏á data/stocks/*.parquet (42 ‡πÑ‡∏ü‡∏•‡πå)

Step 2: ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå (‡∏ó‡∏≥‡πÑ‡∏î‡πâ‡∏ö‡πà‡∏≠‡∏¢‡πÜ ‡πÄ‡∏£‡πá‡∏ß‡∏°‡∏≤‡∏Å!)
   python run_from_parquet.py PTT SET
```

---

## üìã ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

### 1. ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏´‡∏∏‡πâ‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
```bash
python run_from_parquet.py
```

**Output:**
```
Symbol Exchange       Date  Close   Change%  Bars
   SCC      SET 2026-01-14 202.00  4.39%    3000
 PTTGC      SET 2026-01-14  22.50  3.69%    3000
   PTT      SET 2026-01-14  32.75  3.15%    3000
  IRPC      SET 2026-01-14   1.12  2.75%    3000
   ...
```

### 2. ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå 1 ‡∏´‡∏∏‡πâ‡∏ô
```bash
python run_from_parquet.py PTT SET
```

**Output:**
```
‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• 3000 bars
   ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á 2013-09-12 ‡∏ñ‡∏∂‡∏á 2026-01-14

üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥ (‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• 3000 ‡∏ß‡∏±‡∏ô)
============================================================
üìà ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß ¬±1%: 1207 ‡∏ß‡∏±‡∏ô (40.2%)
   - ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏∂‡πâ‡∏ô +1%: 604 ‡∏ß‡∏±‡∏ô
   - ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡∏á -1%: 603 ‡∏ß‡∏±‡∏ô

üìä ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô (‡∏´‡∏•‡∏±‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ¬±1%):
   ‡∏´‡∏•‡∏±‡∏á‡∏ß‡∏±‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô (+1%):
   - ‡∏û‡∏£‡∏∏‡πà‡∏á‡∏ô‡∏µ‡πâ‡∏Ç‡∏∂‡πâ‡∏ô: 33.8%
   - ‡∏û‡∏£‡∏∏‡πà‡∏á‡∏ô‡∏µ‡πâ‡∏•‡∏á: 38.2%
   ...
```

---

## ‚ö° ‡∏Ç‡πâ‡∏≠‡∏î‡∏µ‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ Parquet

### ‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß:

| Action | ‡∏à‡∏≤‡∏Å API | ‡∏à‡∏≤‡∏Å Parquet | ‡πÄ‡∏£‡πá‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô |
|--------|---------|-------------|---------|
| ‡πÇ‡∏´‡∏•‡∏î 1 ‡∏´‡∏∏‡πâ‡∏ô | ~3 ‡∏ß‡∏¥ | ~0.1 ‡∏ß‡∏¥ | **30x** |
| ‡πÇ‡∏´‡∏•‡∏î 50 ‡∏´‡∏∏‡πâ‡∏ô | ~105 ‡∏ß‡∏¥ | ~5 ‡∏ß‡∏¥ | **21x** |
| ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ã‡πâ‡∏≥ | ~3 ‡∏ß‡∏¥ | ~0.1 ‡∏ß‡∏¥ | **30x** |

### ‡∏Ç‡πâ‡∏≠‡∏î‡∏µ‡∏≠‡∏∑‡πà‡∏ô‡πÜ:
- ‚úÖ ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô offline ‡πÑ‡∏î‡πâ
- ‚úÖ ‡πÑ‡∏°‡πà‡∏°‡∏µ rate limit
- ‚úÖ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠ (‡∏ó‡∏∏‡∏Å‡∏´‡∏∏‡πâ‡∏ô‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ä‡∏∏‡∏î‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô)
- ‚úÖ ‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î bandwidth

---

## üîÑ Recommended Workflow

### Production Daily:

```bash
# ‡πÄ‡∏ä‡πâ‡∏≤ 8:00 - ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (automated via cron)
python data_updater.py

# ‡∏ï‡∏•‡∏≠‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏ß‡∏±‡∏ô - ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÑ‡∏î‡πâ‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î
python run_from_parquet.py PTT SET
python run_from_parquet.py CPALL SET
python run_from_parquet.py BDMS SET
# ... ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÑ‡∏î‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏ß‡∏±‡∏ô ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÇ‡∏î‡∏ô rate limit!
```

### ‡πÄ‡∏ã‡πá‡∏ï Cron:
```bash
# ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏ó‡∏∏‡∏Å‡πÄ‡∏ä‡πâ‡∏≤ 8:00
0 8 * * * cd /path/to/predict && python data_updater.py >> logs/updater.log 2>&1
```

---

## üìä ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô Python Script

### Basic:
```python
import pandas as pd

# ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
df = pd.read_parquet('data/stocks/PTT_SET.parquet')

# ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå
latest = df.iloc[-1]
print(f"PTT: ‡∏ø{latest['close']:.2f} ({latest['pct_change']:+.2f}%)")
```

### Advanced - ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏´‡∏•‡∏≤‡∏¢‡∏´‡∏∏‡πâ‡∏ô:
```python
from pathlib import Path
import pandas as pd

# ‡∏≠‡πà‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
stocks_dir = Path('data/stocks')
results = []

for pf in stocks_dir.glob('*.parquet'):
    df = pd.read_parquet(pf)
    latest = df.iloc[-1]
    
    # ‡∏Å‡∏£‡∏≠‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß‡∏°‡∏≤‡∏Å
    if abs(latest['pct_change']) >= 2.0:
        results.append({
            'Symbol': pf.stem.split('_')[0],
            'Change': latest['pct_change'],
            'Close': latest['close']
        })

# ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
summary = pd.DataFrame(results)
print(summary.sort_values('Change', ascending=False))
```

---

## üöÄ Scale Up Example

### ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå 42 ‡∏´‡∏∏‡πâ‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô:
```bash
# ‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤ ~5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ (vs 105 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡∏ñ‡πâ‡∏≤‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å API)
python run_from_parquet.py
```

### ‡∏™‡∏£‡πâ‡∏≤‡∏á Daily Report:
```bash
python run_from_parquet.py > daily_report.txt
```

---

## üí° Best Practices

1. **‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô:**
   ```bash
   python data_updater.py
   ```
   - ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å: ‡∏ä‡πâ‡∏≤ (‡∏î‡∏∂‡∏á 3,000 bars)
   - ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ï‡πà‡∏≠‡πÑ‡∏õ: ‡πÄ‡∏£‡πá‡∏ß (‡∏î‡∏∂‡∏á‡πÅ‡∏Ñ‡πà 100 bars ‡πÉ‡∏´‡∏°‡πà)

2. **‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏à‡∏≤‡∏Å Parquet:**
   ```bash
   python run_from_parquet.py PTT SET
   ```
   - ‡πÄ‡∏£‡πá‡∏ß 30x
   - ‡πÑ‡∏°‡πà‡πÇ‡∏î‡∏ô rate limit

3. **‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤:**
   ```bash
   # ‡∏î‡∏π‡∏≠‡∏≤‡∏¢‡∏∏‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
   ls -lh data/stocks/PTT_SET.parquet
   ```

---

## üéØ ‡∏™‡∏£‡∏∏‡∏õ

| ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô | ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á | ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà |
|---------|--------|---------|
| 1. ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• | `python data_updater.py` | ‡∏ß‡∏±‡∏ô‡∏•‡∏∞‡∏Ñ‡∏£‡∏±‡πâ‡∏á |
| 2. ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå | `python run_from_parquet.py PTT SET` | ‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î |

**‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Production!** üöÄ
