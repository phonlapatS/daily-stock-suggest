# Pattern Detection V2 - Unified Logic (v2.0)

## üéØ Overview (Updated 2026-01-21)

‡∏£‡∏∞‡∏ö‡∏ö **PredictPlus V2.0** ‡πÉ‡∏ä‡πâ **Statistical Pattern Recognition** ‡∏ó‡∏µ‡πà‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏Ç‡∏∂‡πâ‡∏ô‡πÉ‡∏´‡∏°‡πà:
- **Optimal Threshold: 1.25 SD** (Hybrid Volatility)
- **Deep History: 5000 Bars** (~20 ‡∏õ‡∏µ)
- **Stats Filter: ‚â• 30 Matches** (Quality Control)
- **Min Matches:** 0.1% ‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Flexible)

---

## üî¨ V2.0 Logic Breakdown

### **Step 1: Hybrid Volatility Threshold**

**Concept:** ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏±‡∏ô‡∏ú‡∏ß‡∏ô‡πÅ‡∏ö‡∏ö‡∏ú‡∏™‡∏°‡∏ú‡∏™‡∏≤‡∏ô (Short-term SD + Long-term Floor) ‡∏Ñ‡∏π‡∏ì‡∏î‡πâ‡∏ß‡∏¢ 1.25

**Algorithm:**
```python
def calculate_hybrid_threshold(df):
    # Short-term Volatility (20 days)
    short_term_std = df['pct_change'].rolling(window=20).std()
    
    # Long-term Floor (252 days)
    long_term_floor = df['pct_change'].rolling(window=252).std() * 0.50
    
    # Effective STD
    effective_std = np.maximum(short_term_std, long_term_floor)
    
    # 1.25 SD Threshold
    return effective_std * 1.25
```

**Why 1.25 SD?**
- **1.0 SD:** ‡∏à‡∏±‡∏ö‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡πÄ‡∏¢‡∏≠‡∏∞‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ (Noise)
- **2.0 SD:** ‡∏à‡∏±‡∏ö‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡∏ô‡πâ‡∏≠‡∏¢‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ (Stats ‡πÑ‡∏°‡πà‡∏û‡∏≠)
- **1.25 SD:** ‡∏™‡∏°‡∏î‡∏∏‡∏•‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î ‡πÑ‡∏î‡πâ‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠‡∏ó‡∏≤‡∏á‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥ (30-120 Matches)

---

### **Step 2: Pattern Detection**

**Concept:** ‡πÅ‡∏õ‡∏•‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏´‡∏±‡∏™ Pattern
- **`+`**: ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á > Threshold (‡∏Ç‡∏∂‡πâ‡∏ô‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô)
- **`-`**: ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á < -Threshold (‡∏•‡∏á‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô)
- **`.`**: ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á Threshold (Quiet - ‡πÑ‡∏°‡πà‡∏ô‡∏≥‡∏°‡∏≤‡∏Ñ‡∏¥‡∏î)

**Deep History (5000 Bars):**
‡πÄ‡∏£‡∏≤‡∏™‡πÅ‡∏Å‡∏ô‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á 5,000 ‡∏ß‡∏±‡∏ô (‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 20 ‡∏õ‡∏µ) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏≤ Pattern ‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ô
- ‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô Sample Size ‡πÄ‡∏õ‡πá‡∏ô 5-10 ‡πÄ‡∏ó‡πà‡∏≤‡∏à‡∏≤‡∏Å‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏î‡∏¥‡∏°
- ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥ (Win Rate) ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡πà‡∏≤‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏ñ‡∏∑‡∏≠‡∏™‡∏π‡∏á‡∏°‡∏≤‡∏Å

---

### **Step 3: 4-Layer Filtering**

‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î ‡πÄ‡∏£‡∏≤‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≠‡∏á 4 ‡∏ä‡∏±‡πâ‡∏ô:

1.  **Min Matches Filter:**
    - ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Å‡∏¥‡∏î‡∏ã‡πâ‡∏≥‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ **0.1% ‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•** (‡πÄ‡∏ä‡πà‡∏ô 5000 bars ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Å‡∏¥‡∏î ‚â• 5 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á)
    - ‡∏´‡∏£‡∏∑‡∏≠‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥ 3 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Pattern ‡∏¢‡∏≤‡∏ß‡πÜ)

2.  **Context-Aware Filter:**
    - ‡∏Å‡∏£‡∏≠‡∏á Pattern ‡∏ó‡∏µ‡πà‡∏Ç‡∏±‡∏î‡πÅ‡∏¢‡πâ‡∏á‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
    - ‡∏ñ‡πâ‡∏≤‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏ö‡∏ß‡∏Å‡πÅ‡∏£‡∏á (+) ‚Üí ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Pattern ‡∏ó‡∏µ‡πà‡∏à‡∏ö‡∏î‡πâ‡∏ß‡∏¢ `+`
    - ‡∏ñ‡πâ‡∏≤‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏•‡∏ö‡πÅ‡∏£‡∏á (-) ‚Üí ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Pattern ‡∏ó‡∏µ‡πà‡∏à‡∏ö‡∏î‡πâ‡∏ß‡∏¢ `-`

3.  **Stats Quality Filter (Crucial V2 Feature):**
    - ‡∏Å‡∏£‡∏≠‡∏á‡∏ó‡∏¥‡πâ‡∏á‡∏ñ‡πâ‡∏≤ **Stats < 30 Matches**
    - ‡πÄ‡∏û‡∏£‡∏≤‡∏∞ Margin of Error ‡∏à‡∏∞‡∏™‡∏π‡∏á‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ (¬±18%+)
    - ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Pattern ‡∏ó‡∏µ‡πà "‡πÅ‡∏ô‡πà‡∏ô" ‡∏à‡∏£‡∏¥‡∏á‡πÜ

4.  **Probability vs Stats Balance:**
    - "‡∏¢‡∏¥‡πà‡∏á Prob% ‡∏™‡∏π‡∏á ‡∏¢‡∏¥‡πà‡∏á‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ Stats ‡∏°‡∏≤‡∏Å"
    - Prob ‚â• 80% ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ Stats ‚â• 20
    - Prob ‚â• 70% ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ Stats ‚â• 15

---

## üìä Example Calculation

**Scenario:** ‡∏´‡∏∏‡πâ‡∏ô PTT ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏ö‡∏ß‡∏Å +2.5% (Threshold ¬±1.5%) ‚Üí Pattern `+`

1.  **Scan History (5000 days):** ‡πÄ‡∏à‡∏≠‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô `+` ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î 200 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á
2.  **Check Next Day:**
    - 110 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡∏ß‡∏±‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ‡∏Ç‡∏∂‡πâ‡∏ô (Wins)
    - 90 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡∏ß‡∏±‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ‡∏•‡∏á (Losses)
3.  **Calculate Stats:**
    - Win Rate: 55% (110/200)
    - Stats: 110/200 (200 > 30 ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô)
4.  **Result:**
    - **Chance:** üü¢ UP
    - **Prob:** 55%
    - **Stats:** 110/200 (5000)

---

## üåê Scope of V2.0

| Feature | Details |
|---------|---------|
| **Threshold** | 1.25 SD (Hybrid) |
| **History** | 5000 Bars |
| **Assets** | Thai (SET100), US (NASDAQ), China (ADRs), Metals |
| **Filters** | Context-Aware, Stats ‚â• 30 |
| **Output** | Console Table, CSV Export |

---

**‡∏™‡∏£‡∏∏‡∏õ:** V2.0 ‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏à‡∏≤‡∏Å "‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏ö Pattern ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ" ‡πÄ‡∏õ‡πá‡∏ô **"Statistical Pattern Analysis"** ‡∏ó‡∏µ‡πà‡πÄ‡∏ô‡πâ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡πà‡∏≤‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏ñ‡∏∑‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å üìä‚ú®
